### STAGE 1: PREPARING AND MAVEN BUILDING
FROM maven:3.8.5-openjdk-11 AS builders
COPY ./gateway/pom.xml /app/
COPY ./gateway/src /app/src
WORKDIR /app/
RUN mvn clean test
RUN mvn clean install -P prod


### STAGE 2: DEPLOY APP
FROM openjdk:11.0.14-jdk
WORKDIR /app/
COPY --from=builders /app/target/gateway-0.0.1.jar /app/
ENTRYPOINT ["java", "-jar","gateway-0.0.1.jar"]
EXPOSE 8055



